<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ehrenamtsnetz • Gesuche</title>
    <link rel="stylesheet" href="./styles.css" />
    <script src="./theme.js" defer></script>
    <script src="./labels.js" defer></script>
    <script src="./nav.js" defer></script>
    <script src="./nav-active.js" defer></script>
    <script src="./data-store.js" defer></script>
    <script src="./session.js" defer></script>
    <script src="./news-controls.js" defer></script>
    <script src="./ui-drawers.js" defer></script>
    <script src="./gesuche-form.js" defer></script>
    <script src="./gesuche-filters.js" defer></script>
  </head>

  <body>
    <header class="header">
      <div class="container header__inner">
        <a class="brand" href="./index.html">Ehrenamtsnetz</a>

        <nav class="nav">
          <div class="nav__links" data-desktop-nav></div>
          <div class="nav__menu">
            <button
              class="nav__toggle"
              type="button"
              aria-label="Menü öffnen"
              aria-expanded="false"
              aria-controls="mobileMenu"
              data-nav-toggle
            >
              <span class="nav__toggleLines" aria-hidden="true">
                <span class="nav__toggleLine"></span>
                <span class="nav__toggleLine"></span>
                <span class="nav__toggleLine"></span>
              </span>
            </button>
            <div class="nav__dropdown" id="mobileMenu" hidden>
              <nav class="nav__dropdownNav" aria-label="Menü" data-mobile-menu></nav>
            </div>
          </div>
          <div class="nav__actions">
            <button class="themeToggle" type="button" aria-label="Dunkelmodus aktivieren" aria-pressed="false" data-theme-toggle>
              <span class="themeToggle__icon themeToggle__icon--sun" aria-hidden="true">
                <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 18a6 6 0 100-12 6 6 0 000 12z"/>
                  <path d="M12 2.25a.75.75 0 01.75.75V5a.75.75 0 01-1.5 0V3A.75.75 0 0112 2.25z"/>
                  <path d="M12 19a.75.75 0 01.75.75v2a.75.75 0 01-1.5 0v-2A.75.75 0 0112 19z"/>
                  <path d="M4.72 4.72a.75.75 0 011.06 0l1.41 1.41a.75.75 0 11-1.06 1.06L4.72 5.78a.75.75 0 010-1.06z"/>
                  <path d="M16.81 16.81a.75.75 0 011.06 0l1.41 1.41a.75.75 0 11-1.06 1.06l-1.41-1.41a.75.75 0 010-1.06z"/>
                  <path d="M2.25 12c0-.414.336-.75.75-.75h2a.75.75 0 010 1.5H3a.75.75 0 01-.75-.75z"/>
                  <path d="M19 12c0-.414.336-.75.75-.75h2a.75.75 0 010 1.5h-2A.75.75 0 0119 12z"/>
                  <path d="M4.72 19.28a.75.75 0 010-1.06l1.41-1.41a.75.75 0 111.06 1.06l-1.41 1.41a.75.75 0 01-1.06 0z"/>
                  <path d="M16.81 7.19a.75.75 0 010-1.06l1.41-1.41a.75.75 0 011.06 1.06l-1.41 1.41a.75.75 0 01-1.06 0z"/>
                </svg>
              </span>
              <span class="themeToggle__icon themeToggle__icon--moon" aria-hidden="true">
                <svg fill="currentColor" viewBox="144 144 512 512" xmlns="http://www.w3.org/2000/svg">
                  <g fill-rule="evenodd">
                    <path d="m586.16 520.09c-37.855 49.766-97.699 81.895-165.04 81.895-114.46.0-207.27-92.801-207.27-207.27.0-91.602 59.426-169.31 141.82-196.71-121.23 159.34 35.664 386.83 230.49 322.09z"/>
                    <path d="m516.45 388.75 14.566 47.379 47.367 14.559-47.367 14.555-14.566 47.379-14.559-47.379-47.375-14.555 47.375-14.559z"/>
                    <path d="m428.86 287.64 7.293 23.734 23.723 7.2891-23.723 7.2969-7.293 23.723-7.293-23.723-23.727-7.2969 23.727-7.2891z"/>
                    <path d="m416.86 399.47 7.293 23.727 23.727 7.293-23.727 7.2891-7.293 23.727-7.2891-23.727-23.73-7.2891 23.73-7.293z"/>
                  </g>
                </svg>
              </span>
            </button>
          </div>
        </nav>
      </div>
    </header>


    <section class="section section--airy">
      <div class="container">
        <div class="gesuche__layout gesuche__layout--single">
          <!-- MAIN -->
          <div class="gesuche__main">
            <div class="gesuche__card newsCard" data-news-card>
            <div class="listcardShell">
              <div class="listcard">
                <div class="listcard__search">
                  <input class="gesuche__search" placeholder="Suche nach Thema, Ort, Stichwort…" data-gesuche-search />
                  <button class="nav__link gesuche__searchBtn" type="button" data-gesuche-search-btn>Suchen</button>
                </div>
                <div class="listcard__inner">
                  <div class="listcard__header">
                    <button class="newsCard__control listcard__control" type="button" aria-label="Gesuche sortieren" aria-expanded="false" data-open-sort>
                      <span class="newsCard__controlLines" aria-hidden="true">
                        <span class="newsCard__controlLine"></span>
                        <span class="newsCard__controlLine"></span>
                        <span class="newsCard__controlLine"></span>
                      </span>
                    </button>
                    <h1 class="listcard__title" id="gesuche-title">Gesuche</h1>
                    <button class="newsCard__control listcard__control" type="button" aria-label="Gesuche filtern" aria-expanded="false" data-open-filter>
                      <span class="newsCard__controlLines" aria-hidden="true">
                        <span class="newsCard__controlLine"></span>
                        <span class="newsCard__controlLine"></span>
                        <span class="newsCard__controlLine"></span>
                      </span>
                    </button>
                  </div>
                  <div class="listcard__actions">
                    <a class="listcard__createLink" href="./gesuch-erstellen.html" data-auth-only hidden>+ Gesuch erstellen</a>
                  </div>
                </div>
              </div>
              <div class="gesuche__activeFilters">
                <div class="gesuche__tags" id="gesuche-filters"></div>
                <div class="sub gesuche__filterSubtitle" id="gesuche-filter-subtitle">Gefiltert nach: Alle Gesuche</div>
              </div>
              <div class="listcard__drawer" data-drawer="sort" hidden>
                <div class="newsCard__menu" data-news-menu="sort" role="menu" aria-label="Sortierung">
                  <div class="newsCard__menuLabel">Sortieren nach</div>
                  <div class="newsCard__menuDivider" aria-hidden="true"></div>
                  <button class="newsCard__menuItem is-active" type="button" data-news-sort="newest">Neueste zuerst</button>
                  <button class="newsCard__menuItem" type="button" data-news-sort="oldest">Älteste zuerst</button>
                  <button class="newsCard__menuItem" type="button" data-news-sort="distance">Entfernung</button>
                </div>
              </div>
              <div class="listcard__drawer" data-drawer="filter" hidden>
                <div class="listcard__drawerSection">
                  <div class="listcard__drawerTitle">Filter</div>
                  <select class="gesuche__select" aria-label="Gesuchstyp auswählen" data-gesuche-type-filter>
                    <option value="all">Alle Typen</option>
                    <option value="fsj">FSJ</option>
                    <option value="pflegestelle">Pflegestelle</option>
                    <option value="urlaub">Urlaub</option>
                    <option value="aushilfe">Aushilfe</option>
                    <option value="mitglied">Mitglied</option>
                    <option value="freiwillig">Freiwillig</option>
                  </select>
                </div>
                <div class="newsCard__menu" data-news-menu="filter" role="menu" aria-label="Filter">
                  <div class="newsCard__menuLabel">Filtern nach</div>
                  <div class="newsCard__menuDivider" aria-hidden="true"></div>
                  <button class="newsCard__menuItem is-active" type="button" data-news-filter="all">Alle</button>
                  <button class="newsCard__menuItem" type="button" data-news-filter="vor_ort">Vor Ort</button>
                  <button class="newsCard__menuItem" type="button" data-news-filter="online">Online</button>
                  <button class="newsCard__menuItem" type="button" data-news-filter="hybrid">Hybrid</button>
                </div>
                <details class="gesuche__filterPanel">
                  <summary>Filter anzeigen</summary>
                  <div class="gesuche__filterPanelBody">
                    <details class="gesuche__filter" open>
                      <summary>Themengebiet</summary>
                      <div class="gesuche__filterBody">
                        <label class="gesuche__chk"><input type="checkbox" /> Kinder</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Geflüchtete</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Inklusiv</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Ältere</label>

                        <div class="gesuche__sep"></div>

                        <label class="gesuche__chk"><input type="checkbox" /> Tiere</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Natur</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Sport</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Kreativ</label>
                      </div>
                    </details>

                    <details class="gesuche__filter">
                      <summary>Ort</summary>
                      <div class="gesuche__filterBody">
                        <label class="gesuche__chk"><input type="checkbox" /> In der Nähe</label>
                        <label class="gesuche__chk"><input type="checkbox" /> In Deutschland</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Im Ausland</label>
                      </div>
                    </details>

                    <details class="gesuche__filter">
                      <summary>Modus</summary>
                      <div class="gesuche__filterBody">
                        <label class="gesuche__chk"><input type="checkbox" /> Online</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Vor Ort</label>
                      </div>
                    </details>

                    <details class="gesuche__filter">
                      <summary>Aufwand</summary>
                      <div class="gesuche__filterBody">
                        <label class="gesuche__chk"><input type="checkbox" /> kurzfristig (3–30 Min)</label>
                        <label class="gesuche__chk"><input type="checkbox" /> mittelfristig (halber Tag)</label>
                        <label class="gesuche__chk"><input type="checkbox" /> langfristig (mehrere Tage)</label>
                        <label class="gesuche__chk"><input type="checkbox" /> FSJ o.ä.</label>
                      </div>
                    </details>

                    <details class="gesuche__filter">
                      <summary>Rahmen</summary>
                      <div class="gesuche__filterBody">
                        <label class="gesuche__chk"><input type="checkbox" /> Mit ÖPNV erreichbar</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Geld (Aufwandsentschädigung)</label>
                        <label class="gesuche__chk"><input type="checkbox" /> Barrierefrei</label>
                      </div>
                    </details>

                    <div class="gesuche__sideActions">
                      <button class="nav__link gesuche__apply" type="button">Anwenden</button>
                      <button class="nav__link gesuche__reset gesuche__clear" type="button" data-gesuche-clear-filters>
                        Filter zurücksetzen
                      </button>
                    </div>
                  </div>
                </details>
              </div>
            </div>

              <div class="gesuche__list" data-gesuche-list data-news-list>
                <!-- Gesuch row 1 -->
                <article
                  class="gesuche__row"
                  data-news-item
                  data-news-type="vor_ort"
                  data-gesuch-type="aushilfe"
                  data-news-date="2024-06-02"
                  data-news-distance="2"
                  data-verein-name="Seniorenhilfe Berlin e.V."
                  data-verein-address="Kastanienallee 14, 10435 Berlin"
                  data-verein-email="kontakt@seniorenhilfe-berlin.de"
                  data-verein-phone="+49 30 234567-0"
                  data-verein-contact="Maren Hoffmann"
                  data-verein-email-visible="true"
                  data-verein-phone-visible="false"
                >
                  <div class="gesuche__media" aria-hidden="true"></div>
                  <div class="gesuche__left">
                    <h3 class="gesuche__title">Begleitung zum Arzt gesucht</h3>
                    <div class="gesuche__meta">Berlin • 2 km • 30–90 Min • Vor Ort</div>

                    <div class="gesuche__tags">
                      <span class="gesuche__tag">Ältere</span>
                      <span class="gesuche__tag">Begleitung</span>
                      <span class="gesuche__tag">Kurzfristig</span>
                    </div>

                    <div class="gesuche__text">
                      Kurzer Teaser: Worum geht es? Was ist wichtig? Welche Zeiten? Was sollte man mitbringen?
                    </div>
                  </div>

                  <div class="gesuche__right">
                    <button class="nav__link gesuche__open" type="button">Öffnen</button>
                    <button class="nav__link gesuche__save" type="button">Merken</button>
                  </div>
                </article>

                <!-- Gesuch row 2 -->
                <article
                  class="gesuche__row"
                  data-news-item
                  data-news-type="online"
                  data-gesuch-type="freiwillig"
                  data-news-date="2024-05-24"
                  data-news-distance="0"
                  data-verein-name="Lernbrücke Online"
                  data-verein-address="Digitale Beratung, Berlin"
                  data-verein-email="team@lernbruecke-online.de"
                  data-verein-phone="+49 30 987654-0"
                  data-verein-contact="Said Yilmaz"
                  data-verein-email-visible="true"
                  data-verein-phone-visible="true"
                >
                  <div class="gesuche__media" aria-hidden="true"></div>
                  <div class="gesuche__left">
                    <h3 class="gesuche__title">Online Nachhilfe (Mathe) für Schüler</h3>
                    <div class="gesuche__meta">Online • flexibel • 1–2 Std/Woche</div>

                    <div class="gesuche__tags">
                      <span class="gesuche__tag">Kinder</span>
                      <span class="gesuche__tag">Online</span>
                      <span class="gesuche__tag">Wissen</span>
                    </div>

                    <div class="gesuche__text">
                      Kurzer Teaser: Zielgruppe, Zeitslots, Level und gewünschte Skills.
                    </div>
                  </div>

                  <div class="gesuche__right">
                    <button class="nav__link gesuche__open" type="button">Öffnen</button>
                    <button class="nav__link gesuche__save" type="button">Merken</button>
                  </div>
                </article>

                <!-- Gesuch row 3 -->
                <article
                  class="gesuche__row"
                  data-news-item
                  data-news-type="vor_ort"
                  data-gesuch-type="pflegestelle"
                  data-news-date="2024-05-18"
                  data-news-distance="5"
                  data-verein-name="Tierfreunde Hamburg"
                  data-verein-address="Barkhausenweg 2, 22339 Hamburg"
                  data-verein-email="kontakt@tierfreunde-hh.de"
                  data-verein-phone="+49 40 555123-0"
                  data-verein-contact="Lina Vogt"
                  data-verein-email-visible="false"
                  data-verein-phone-visible="true"
                >
                  <div class="gesuche__media" aria-hidden="true"></div>
                  <div class="gesuche__left">
                    <h3 class="gesuche__title">Hilfe im Tierheim am Wochenende</h3>
                    <div class="gesuche__meta">Hamburg • 5 km • halber Tag • Vor Ort</div>

                    <div class="gesuche__tags">
                      <span class="gesuche__tag">Tiere</span>
                      <span class="gesuche__tag">Wochenende</span>
                      <span class="gesuche__tag">Vor Ort</span>
                    </div>

                    <div class="gesuche__text">
                      Kurzer Teaser: Aufgaben (Füttern, Reinigen, Spaziergänge), Kleidung, Treffpunkt.
                    </div>
                  </div>

                  <div class="gesuche__right">
                    <button class="nav__link gesuche__open" type="button">Öffnen</button>
                    <button class="nav__link gesuche__save" type="button">Merken</button>
                  </div>
                </article>

                <!-- More placeholders -->
                <article
                  class="gesuche__row"
                  data-news-item
                  data-news-type="vor_ort"
                  data-gesuch-type="fsj"
                  data-news-date="2024-05-12"
                  data-news-distance="4"
                  data-verein-name="Nachbarschaftshaus Nord"
                  data-verein-address="Nordplatz 5, 30159 Hannover"
                  data-verein-email="info@nachbarschaft-nord.de"
                  data-verein-phone="+49 511 780900"
                  data-verein-contact=""
                  data-verein-email-visible="true"
                  data-verein-phone-visible="false"
                >
                  <div class="gesuche__media" aria-hidden="true"></div>
                  <div class="gesuche__left">
                    <h3 class="gesuche__title">FSJ im Nachbarschaftshaus</h3>
                    <div class="gesuche__meta">Hannover • 4 km • FSJ • Vor Ort</div>
                    <div class="gesuche__tags">
                      <span class="gesuche__tag">FSJ</span>
                      <span class="gesuche__tag">Langfristig</span>
                      <span class="gesuche__tag">Vor Ort</span>
                    </div>
                    <div class="gesuche__text">
                      Langfristige Unterstützung im Quartierstreff: Planung, Begleitung von Angeboten und Hilfe im Alltag.
                    </div>
                  </div>
                  <div class="gesuche__right">
                    <button class="nav__link gesuche__open" type="button">Öffnen</button>
                    <button class="nav__link gesuche__save" type="button">Merken</button>
                  </div>
                </article>
              </div>

              <div class="gesuche__more">
                <button class="nav__link gesuche__moreBtn" type="button">Weitere…</button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <div class="gesuchDetail" data-gesuch-detail hidden>
      <div class="gesuchDetail__overlay" data-gesuch-detail-close></div>
      <div class="gesuchDetail__panel" role="dialog" aria-modal="true" aria-labelledby="gesuch-detail-title">
        <button class="gesuchDetail__close" type="button" data-gesuch-detail-close>Schließen</button>
        <div class="gesuchDetail__content">
          <div class="gesuchDetail__meta" data-gesuch-detail-meta></div>
          <h2 class="h2" id="gesuch-detail-title" data-gesuch-detail-title></h2>
          <p class="gesuchDetail__summary" data-gesuch-detail-summary></p>

          <div class="gesuchDetail__section">
            <h3 class="h3">Verein</h3>
            <div class="gesuchDetail__verein" data-gesuch-detail-verein></div>
            <div class="gesuchDetail__address" data-gesuch-detail-address></div>
            <div class="gesuchDetail__contact">
              <div class="gesuchDetail__contactLead" data-gesuch-detail-contact-person></div>
              <div class="gesuchDetail__contactRow" data-gesuch-detail-email></div>
              <div class="gesuchDetail__contactRow" data-gesuch-detail-phone></div>
            </div>
            <div class="gesuchDetail__note" data-gesuch-detail-note></div>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="container footer__inner">
        <div>Impressum • Kontakt • Datenschutz</div>
      </div>
    </footer>

    <script>
      (function () {
        const filterContainer = document.getElementById("gesuche-filters");
        const filterSubtitle = document.getElementById("gesuche-filter-subtitle");
        const subtitle = document.getElementById("gesuche-subtitle");
        if (!filterContainer || !filterSubtitle) return;

        const params = new URLSearchParams(window.location.search);
        const path = params.get("path");
        const mode = params.get("mode");
        const role = params.get("role");
        const topic = params.get("topic");
        const type = params.get("type");

        const labelMap = {
          path: "Bereich",
          mode: "Modus",
          role: "Rolle",
          topic: "Thema",
          type: "Typ",
        };

        const formatValue = (value) =>
          value
            .split(/[-_]/)
            .map((part) => part.charAt(0).toUpperCase() + part.slice(1))
            .join(" ");

        const filterChips = [];
        if (path) filterChips.push(`${labelMap.path}: ${formatValue(path)}`);
        if (mode) filterChips.push(`${labelMap.mode}: ${formatValue(mode)}`);
        if (role) filterChips.push(`${labelMap.role}: ${formatValue(role)}`);
        if (topic) filterChips.push(`${labelMap.topic}: ${formatValue(topic)}`);
        if (type) filterChips.push(`${labelMap.type}: ${formatValue(type)}`);

        if (filterChips.length) {
          filterContainer.innerHTML = "";
          filterChips.forEach((label) => {
            const chip = document.createElement("span");
            chip.className = "gesuche__tag";
            chip.textContent = label;
            filterContainer.appendChild(chip);
          });

          const summaryText = `Gefiltert nach: ${filterChips.join(" · ")}`;
          filterSubtitle.textContent = summaryText;
          if (subtitle) subtitle.textContent = summaryText;
        } else {
          filterContainer.innerHTML = "";
          filterSubtitle.textContent = "Gefiltert nach: Alle Gesuche";
        }
      })();
    </script>
  </body>
</html>
